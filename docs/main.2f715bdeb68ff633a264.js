!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="3177845424933048caec")}({"124e5333d240f9e9ac9d":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VisibilityConditions={IS_ADMIN:"admin",CAN_EDIT:"edit",READ_ONLY:"readOnly",SIGNED_IN:"signedIn",SIGNED_OUT:"signedOut",ALWAYS:"always"},t.StorageScope={BOARD:"board",CARD:"card",MEMBER:"member",ORGANIZATION:"organization"},t.StorageVisibility={SHARED:"shared",PRIVATE:"private"},t.BadgeColors={BLUE:"blue",GREEN:"green",ORANGE:"orange",RED:"red",YELLOW:"yellow",PURPLE:"purple",PINK:"pink",SKY:"sky",LIME:"lime",LIGHTGRAY:"light-gray"}},"1b6695f247aa876d8126":function(e,t,n){"use strict";e.exports=function(e){if("number"!=typeof e)throw new TypeError("Expected a number");var t=e>0?Math.floor:Math.ceil;return{days:t(e/864e5),hours:t(e/36e5)%24,minutes:t(e/6e4)%60,seconds:t(e/1e3)%60,milliseconds:t(e)%1e3}}},"2053768d2cb9c97789de":function(e,t,n){"use strict";(function(e,r){var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=h(n("3454881a11013d365bc6")),a=h(n("913e7ad1aff3f4c0d6e7")),s=h(n("496ef9d2aa90e6c719d3")),c=h(n("592b157562d5dc0f66dc")),l=h(n("f1e2a52aad8d956dc791")),f=h(n("fec2ccc126ffad19d204")),d=h(n("e33b6889d58ae4e02528")),p=h(n("29a154187775a20b3f6a"));function h(e){return e&&e.__esModule?e:{default:e}}function v(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(i,o){try{var u=t[i](o),a=u.value}catch(e){return void n(e)}if(!u.done)return Promise.resolve(a).then(function(e){r("next",e)},function(e){r("throw",e)});e(a)}("next")})}}Function.prototype.$asyncbind=function t(n,o){function u(){return a.apply(n,arguments)}Function.prototype.$asyncbind||Object.defineProperty(Function.prototype,"$asyncbind",{value:t,enumerable:!1,configurable:!0,writable:!0}),t.trampoline||(t.trampoline=function(e,t,n,r,i){return function o(u){for(;u;){if(u.then)return u=u.then(o,r),i?void 0:u;try{if(u.pop){if(u.length)return u.pop()?t.call(e):u;u=n}else u=u.call(e)}catch(e){return r(e)}}}}),t.LazyThenable||(t.LazyThenable=function(){function e(e){return e&&e instanceof Object&&"function"==typeof e.then}function t(n,r,i){try{var o=i?i(r):r;if(n===o)return n.reject(new TypeError("Promise resolution loop"));e(o)?o.then(function(e){t(n,e)},function(e){n.reject(e)}):n.resolve(o)}catch(e){n.reject(e)}}function n(e){}function r(){}function i(n,i){var o=new r;try{this._resolver(function(r){return e(r)?r.then(n,i):t(o,r,n)},function(e){t(o,e,i)})}catch(e){t(o,e,i)}return o}function o(e){this._resolver=e,this.then=i}return r.prototype={resolve:n,reject:n,then:function(e,t){this.resolve=e,this.reject=t}},o.resolve=function(e){return o.isThenable(e)?e:{then:function(t){return t(e)}}},o.isThenable=e,o}(),t.EagerThenable=t.Thenable=(t.EagerThenableFactory=function(t){t=t||"object"===(void 0===e?"undefined":i(e))&&e.nextTick||"function"==typeof r&&r||function(e){setTimeout(e,0)};var n=function(){var e=[],n=0,r=1024;function i(){for(;e.length-n;){try{e[n]()}catch(e){}e[n++]=void 0,n===r&&(e.splice(0,r),n=0)}}return function(r){e.push(r),e.length-n==1&&t(i)}}();function o(e){if(e){var t=this;e(function(e){t.resolve(e)},function(e){t.reject(e)})}}function u(e,t){if("function"==typeof e.y)try{var n=e.y.call(void 0,t);e.p.resolve(n)}catch(t){e.p.reject(t)}else e.p.resolve(t)}function a(e,t){if("function"==typeof e.n)try{var n=e.n.call(void 0,t);e.p.resolve(n)}catch(t){e.p.reject(t)}else e.p.reject(t)}return o.prototype={resolve:function(e){if(void 0===this.state){if(e===this)return this.reject(new TypeError("Attempt to resolve promise with self"));var t=this;if(e&&("function"==typeof e||"object"===(void 0===e?"undefined":i(e))))try{var r=0,o=e.then;if("function"==typeof o)return void o.call(e,function(e){r++||t.resolve(e)},function(e){r++||t.reject(e)})}catch(e){return void(r||this.reject(e))}this.state=u,this.v=e,t.c&&n(function(){for(var n=0,r=t.c.length;n<r;n++)u(t.c[n],e)})}},reject:function(e){if(void 0===this.state){this.state=a,this.v=e;var t=this.c;t&&n(function(){for(var n=0,r=t.length;n<r;n++)a(t[n],e)})}},then:function(e,t){var r=new o,i={y:e,n:t,p:r};if(void 0===this.state)this.c?this.c.push(i):this.c=[i];else{var u=this.state,a=this.v;n(function(){u(i,a)})}return r}},o.resolve=function(e){if(e&&e instanceof o)return e;var t=new o;return t.resolve(e),t},o.reject=function(e){if(e&&e instanceof o)return e;var t=new o;return t.reject(e),t},o.version="2.3.3-nodent",o})());var a=this;switch(o){case!0:return new t.Thenable(u);case 0:return new t.LazyThenable(u);case void 0:return u.then=u,u;default:return function(){try{return a.apply(n,arguments)}catch(e){return o(e)}}}};var y=function(){function e(t){var n=this,r=t.window,i=t.TrelloPowerUp,o=t.baseUrl,h=t.maxDiscussionDuration;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.handleCardButtons=function(){var e=v(function*(e){return[{icon:n.baseUrl+"/assets/powerup/timer.svg",text:"Discussion",callback:n.handleDiscussion},{icon:n.baseUrl+"/assets/powerup/heart.svg",text:"Vote    "+((yield n.voting.hasCurrentMemberVoted(e))?"☑":"☐"),callback:n.handleVoting}]});return function(t){return e.apply(this,arguments)}}(),this.handleCardBadges=function(){var e=v(function*(e){return[yield n.elapsedCardBadge.render(e),yield n.votingCardBadge.render(e)].filter(function(e){return e})});return function(t){return e.apply(this,arguments)}}(),this.handleCardDetailBadges=function(){var e=v(function*(e){return[yield n.elapsedCardDetailBadge.render(e),yield n.votingCardDetailBadge.render(e)].filter(function(e){return e})});return function(t){return e.apply(this,arguments)}}(),this.handleCardBackSection=function(){var e=v(function*(e){return{title:"Discussion",icon:n.baseUrl+"/assets/powerup/timer.svg",content:{type:"iframe",url:e.signUrl(n.baseUrl+"/discussion-ui.html"),height:120}}});return function(t){return e.apply(this,arguments)}}(),this.handleListSorters=function(){return[{text:"Most Votes",callback:function(){var e=v(function*(e,t){return{sortedIds:(yield n.trello.Promise.all(t.cards.map(function(){var t=v(function*(t){var r=yield n.voting.countVotesByCard(e,t.id);return Object.assign({leanCoffeeVotes:r},t)});return function(e){return t.apply(this,arguments)}}()))).sort(function(e,t){return e.leanCoffeeVotes<t.leanCoffeeVotes?1:t.leanCoffeeVotes<e.leanCoffeeVotes?-1:0}).map(function(e){return e.id})}});return function(t,n){return e.apply(this,arguments)}}()}]},this.showSettings=function(e){return e.popup({title:"Leaner Coffee v0.4.0",url:n.baseUrl+"/settings.html",height:184})},this.handleVoting=function(){var e=v(function*(e){if(yield n.voting.canCurrentMemberVote(e)){var t=(yield n.voting.getVotes(e))||{},r=yield e.member("id","username","fullName","avatar");t[r.id]?delete t[r.id]:t[r.id]={username:r.username,fullName:r.fullName,avatar:r.avatar},n.cardStorage.saveVotes(e,t)}else e.popup({title:"Lean Coffee",url:n.baseUrl+"/too_many_votes.html",args:{maxVotes:yield n.voting.getMaxVotes(e)},height:98})});return function(t){return e.apply(this,arguments)}}(),this.handleDiscussion=function(){var e=v(function*(e){if(yield n.discussion.isOngoingOrPausedForAnotherCard(e)){var t=yield n.boardStorage.getDiscussionStatus(e),r=yield n.boardStorage.getDiscussionCardId(e),i=(yield e.cards("id","name")).find(function(e){return e.id===r}).name;e.popup({title:"Lean Coffee",url:n.baseUrl+"/ongoing_or_paused.html",args:{currentCardBeingDiscussed:i,currentDiscussionStatus:t},height:120})}else{var o=[];switch(!0){case yield n.discussion.isOngoingFor(e):o=[{text:"Pause timer",callback:function(e){n.discussion.pause(e),e.closePopup()}},{text:"End discussion",callback:function(e){n.discussion.end(e),e.closePopup()}}];break;case yield n.discussion.isPausedFor(e):o=[{text:"Restart timer",callback:function(e){n.discussion.start(e),e.closePopup()}},{text:"End discussion",callback:function(e){n.discussion.end(e),e.closePopup()}}];break;default:o=[{text:"Start timer",callback:function(e){n.discussion.start(e),e.closePopup()}}]}e.popup({title:"Lean Coffee",items:o})}});return function(t){return e.apply(this,arguments)}}(),this.w=r,this.trello=i,this.baseUrl=o,this.boardStorage=new u.default,this.cardStorage=new a.default,this.discussion=new d.default(this.w,this.baseUrl,h),this.voting=new p.default(this.trello),this.elapsedCardBadge=new s.default(this.discussion),this.elapsedCardDetailBadge=new c.default(this.discussion),this.votingCardBadge=new l.default(this.baseUrl,this.voting),this.votingCardDetailBadge=new f.default(this.baseUrl,this.voting)}return o(e,[{key:"start",value:function(){this.trello.initialize({"card-buttons":this.handleCardButtons,"card-badges":this.handleCardBadges,"card-detail-badges":this.handleCardDetailBadges,"card-back-section":this.handleCardBackSection,"list-sorters":this.handleListSorters,"show-settings":this.showSettings})}}]),e}();t.default=y}).call(this,n("26d59f808dff3e83c741"),n("e9aab379f407c6096333").setImmediate)},"26d59f808dff3e83c741":function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:u}catch(e){r=u}}();var s,c=[],l=!1,f=-1;function d(){l&&s&&(l=!1,s.length?c=s.concat(c):f=-1,c.length&&p())}function p(){if(!l){var e=a(d);l=!0;for(var t=c.length;t;){for(s=c,c=[];++f<t;)s&&s[f].run();f=-1,t=c.length}s=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===u||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function v(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new h(e,t)),1!==c.length||l||a(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},"29a154187775a20b3f6a":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){return e&&e.__esModule?e:{default:e}}(n("913e7ad1aff3f4c0d6e7"));function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(i,o){try{var u=t[i](o),a=u.value}catch(e){return void n(e)}if(!u.done)return Promise.resolve(a).then(function(e){r("next",e)},function(e){r("throw",e)});e(a)}("next")})}}t.default=function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hasCurrentMemberVoted=function(){var e=i(function*(e){var t=yield n.cardStorage.read(e,r.default.VOTES);return!!t&&!!t[e.getContext().member]});return function(t){return e.apply(this,arguments)}}(),this.getVotes=function(){var e=i(function*(e){return n.cardStorage.read(e,r.default.VOTES)});return function(t){return e.apply(this,arguments)}}(),this.countVotesByCard=function(){var e=i(function*(e,t){var i=yield n.cardStorage.readById(e,r.default.VOTES,t);return i?Object.keys(i).filter(function(e){return i[e]}).length:0});return function(t,n){return e.apply(this,arguments)}}(),this.getMaxVotes=function(){var e=i(function*(e){var t=yield e.list("cards");return Math.ceil(t.cards.length/3)});return function(t){return e.apply(this,arguments)}}(),this.canCurrentMemberVote=function(){var e=i(function*(e){if(yield n.hasCurrentMemberVoted(e))return!0;var t=(yield e.list("cards")).cards.map(function(e){return e.id});return(yield n.countVotesByMember(e,t))<(yield n.getMaxVotes(e))});return function(t){return e.apply(this,arguments)}}(),this.countVotesByMember=function(){var e=i(function*(e,t){return(yield n.promise.all(t.map(function(){var t=i(function*(t){var i=yield n.cardStorage.readById(e,r.default.VOTES,t);return i?!!i[e.getContext().member]:0});return function(e){return t.apply(this,arguments)}}()))).reduce(function(e,t){return e+t},0)});return function(t,n){return e.apply(this,arguments)}}(),this.cardStorage=new r.default,this.promise=t.Promise}},"3177845424933048caec":function(e,t,n){"use strict";var r=function(e){return e&&e.__esModule?e:{default:e}}(n("2053768d2cb9c97789de")),i={hostname:"https://tata-trello-powerups.s3.amazonaws.com",prefix:"/leancoffee-powerup",defaultDuration:3e5,defaultDirection:"DOWN"},o=i.hostname,u=i.port,a=i.prefix;new r.default({window:window,TrelloPowerUp:window.TrelloPowerUp,baseUrl:o+(u?":"+u:"")+a,maxDiscussionDuration:3e5}).start()},"3454881a11013d365bc6":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n("124e5333d240f9e9ac9d"),o=function(e){return e&&e.__esModule?e:{default:e}}(n("a659833de475285b18b3")),u=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,i.StorageScope.BOARD,i.StorageVisibility.SHARED))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"getDiscussionStatus",value:function(e){return this.read(e,t.DISCUSSION_STATUS)}},{key:"getDiscussionCardId",value:function(e){return this.read(e,t.DISCUSSION_CARD_ID)}},{key:"getDiscussionStartedAt",value:function(e){return this.read(e,t.DISCUSSION_STARTED_AT)}},{key:"getDiscussionPreviousElapsed",value:function(e){return this.read(e,t.DISCUSSION_PREVIOUS_ELAPSED)}},{key:"getDiscussionIntervalId",value:function(e){return this.read(e,t.DISCUSSION_INTERVAL_ID)}}]),t}();u.DISCUSSION_STATUS="leancoffeeDiscussionStatus",u.DISCUSSION_CARD_ID="leancoffeeDiscussionCardId",u.DISCUSSION_STARTED_AT="leancoffeeDiscussionStartedAt",u.DISCUSSION_PREVIOUS_ELAPSED="leancoffeeDiscussionPreviousElapsed",u.DISCUSSION_INTERVAL_ID="leancoffeeDiscussionIntervalId",t.default=u},"44d52eca4306d26d5eb8":function(e,t,n){const r=n("1b6695f247aa876d8126"),i=n("e3096d48ecabaf9e4101");e.exports=(e=>{const t=e<0?-e:e,n=e<=-1e3?"-":"";let{days:o,hours:u,minutes:a,seconds:s}=r(t);return s=i(s),o?`${n}${o}:${i(u)}:${i(a)}:${s}`:u?`${n}${u}:${i(a)}:${s}`:`${n}${a}:${s}`})},"496ef9d2aa90e6c719d3":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(e){return e&&e.__esModule?e:{default:e}}(n("44d52eca4306d26d5eb8")),o=n("124e5333d240f9e9ac9d");function u(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(i,o){try{var u=t[i](o),a=u.value}catch(e){return void n(e)}if(!u.done)return Promise.resolve(a).then(function(e){r("next",e)},function(e){r("throw",e)});e(a)}("next")})}}var a=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.EMPTY_TITLE="",this.getText=function(){var e=u(function*(e,t){return(0,i.default)(t)});return function(t,n){return e.apply(this,arguments)}}(),this.getColor=function(){var e=u(function*(e){return(yield n.discussion.isOngoingFor(e))?o.BadgeColors.ORANGE:(yield n.discussion.isPausedFor(e))?o.BadgeColors.YELLOW:o.BadgeColors.LIGHTGRAY});return function(t){return e.apply(this,arguments)}}(),this.discussion=t,this.render=this.render.bind(this)}return r(e,[{key:"getTitle",value:function(){return this.EMPTY_TITLE}},{key:"render",value:function(){var e=u(function*(e){var t=yield this.discussion.getElapsed(e);return t?{title:this.getTitle(e),text:yield this.getText(e,t),color:yield this.getColor(e)}:null});return function(t){return e.apply(this,arguments)}}()}]),e}();t.default=a},"592b157562d5dc0f66dc":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var u=i.get;return void 0!==u?u.call(r):void 0},i=n("e33b6889d58ae4e02528"),o=function(e){return e&&e.__esModule?e:{default:e}}(n("496ef9d2aa90e6c719d3"));function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var a=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,s=Array(a),c=0;c<a;c++)s[c]=arguments[c];return n=o=u(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),o.getTitle=function(){return"Discussion time"},o.render=function(){var e=function(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(i,o){try{var u=t[i](o),a=u.value}catch(e){return void n(e)}if(!u.done)return Promise.resolve(a).then(function(e){r("next",e)},function(e){r("throw",e)});e(a)}("next")})}}(function*(e){return(yield o.discussion.cardStorage.getDiscussionStatus(e))!==i.Statuses.ENDED?null:r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"render",o).call(o,e)});return function(t){return e.apply(this,arguments)}}(),u(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),t}();t.default=a},"698d75b157f24ae829cc":function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},"913e7ad1aff3f4c0d6e7":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n("124e5333d240f9e9ac9d"),o=function(e){return e&&e.__esModule?e:{default:e}}(n("a659833de475285b18b3")),u=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,i.StorageScope.CARD,i.StorageVisibility.SHARED))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"getDiscussionStatus",value:function(e){return this.read(e,t.DISCUSSION_STATUS)}},{key:"getDiscussionElapsed",value:function(e){return this.read(e,t.DISCUSSION_ELAPSED)}},{key:"getDiscussionThumbs",value:function(e){return this.read(e,t.DISCUSSION_THUMBS)}},{key:"saveDiscussionStatus",value:function(e,n){return this.write(e,t.DISCUSSION_STATUS,n)}},{key:"saveDiscussionElapsed",value:function(e,n){return this.write(e,t.DISCUSSION_ELAPSED,n)}},{key:"saveDiscussionThumbs",value:function(e,n){return this.write(e,t.DISCUSSION_THUMBS,n)}},{key:"saveVotes",value:function(e,n){return this.write(e,t.VOTES,n)}},{key:"deleteDiscussionThumbs",value:function(e){return this.delete(e,t.DISCUSSION_THUMBS)}}]),t}();u.DISCUSSION_STATUS="leancoffeeDiscussionStatus",u.DISCUSSION_ELAPSED="leancoffeeDiscussionElapsed",u.DISCUSSION_THUMBS="leancoffeeDiscussionThumbs",u.VOTES="leancoffeeVotes",t.default=u},a659833de475285b18b3:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n("124e5333d240f9e9ac9d"),o=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.StorageScope.MEMBER,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.StorageVisibility.PRIVATE;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.assign(this,{scope:t,visibility:n})}return r(e,[{key:"readById",value:function(e,t,n){return e.get(n,this.visibility,t)}},{key:"read",value:function(e,t){return e.get(this.scope,this.visibility,t)}},{key:"write",value:function(e,t,n){return e.set(this.scope,this.visibility,t,n)}},{key:"writeMultiple",value:function(e,t){return e.set(this.scope,this.visibility,t)}},{key:"delete",value:function(e,t){return e.remove(this.scope,this.visibility,t)}},{key:"deleteMultiple",value:function(e,t){return e.remove(this.scope,this.visibility,t)}},{key:"deleteMultipleById",value:function(e,t,n){return e.remove(n,this.visibility,t)}}]),e}();t.default=o},bb7e453c13d4f6baee8c:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.Types={ELAPSED:{audio:"assets/looking_down.mp3",text:"The timer has elapsed"}},this.w=t,this.baseUrl=n,this.audioContext=new(this.w.AudioContext||this.w.webkitAudioContext)}return r(e,[{key:"load",value:function(e){var t=this;return fetch(e).then(function(e){return e.arrayBuffer()}).then(function(e){return t.audioContext.decodeAudioData(e)}).then(function(e){var n=t.audioContext.createBufferSource();return n.buffer=e,n.connect(t.audioContext.destination),n})}},{key:"play",value:function(){var e=function(){var e=function*(e){(yield this.load(this.baseUrl+"/"+e.audio)).start()}.apply(this,arguments);return new Promise(function(t,n){return function r(i,o){try{var u=e[i](o),a=u.value}catch(e){return void n(e)}if(!u.done)return Promise.resolve(a).then(function(e){r("next",e)},function(e){r("throw",e)});t(a)}("next")})};return function(t){return e.apply(this,arguments)}}()},{key:"open",value:function(e,t){new this.w.Notification(t,{body:e.text,icon:this.baseUrl+"/assets/timer.png"})}},{key:"show",value:function(e,t){var n=this;"Notification"in this.w&&"denied"!==this.w.Notification.permission&&("granted"===this.w.Notification.permission?this.open(e,t):this.w.Notification.requestPermission(function(r){"granted"===r&&n.open(e,t)}))}}]),e}();t.default=i},c4f90655ae719ce885a6:function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var r,i=1,o={},u=!1,a=e.document,s=Object.getPrototypeOf&&Object.getPrototypeOf(e);s=s&&s.setTimeout?s:e,"[object process]"==={}.toString.call(e.process)?r=function(e){t.nextTick(function(){l(e)})}:function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?function(){var t="setImmediate$"+Math.random()+"$",n=function(n){n.source===e&&"string"==typeof n.data&&0===n.data.indexOf(t)&&l(+n.data.slice(t.length))};e.addEventListener?e.addEventListener("message",n,!1):e.attachEvent("onmessage",n),r=function(n){e.postMessage(t+n,"*")}}():e.MessageChannel?function(){var e=new MessageChannel;e.port1.onmessage=function(e){l(e.data)},r=function(t){e.port2.postMessage(t)}}():a&&"onreadystatechange"in a.createElement("script")?function(){var e=a.documentElement;r=function(t){var n=a.createElement("script");n.onreadystatechange=function(){l(t),n.onreadystatechange=null,e.removeChild(n),n=null},e.appendChild(n)}}():r=function(e){setTimeout(l,0,e)},s.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var u={callback:e,args:t};return o[i]=u,r(i),i++},s.clearImmediate=c}function c(e){delete o[e]}function l(e){if(u)setTimeout(l,0,e);else{var t=o[e];if(t){u=!0;try{!function(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(n,r)}}(t)}finally{c(e),u=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n("698d75b157f24ae829cc"),n("26d59f808dff3e83c741"))},e3096d48ecabaf9e4101:function(e,t,n){var r;!function(t){"use strict";function i(e,t){t=t||2;var n,r=Number(e)<0,i=e.toString();return r&&(i=i.slice(1)),n=t-i.length+1,i=new Array(n).join("0").concat(i),(r?"-":"")+i}void 0===(r=function(){return i}.call(t,n,t,e))||(e.exports=r)}(this)},e33b6889d58ae4e02528:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Thumbs=t.Statuses=void 0;var r=u(n("3454881a11013d365bc6")),i=u(n("913e7ad1aff3f4c0d6e7")),o=u(n("bb7e453c13d4f6baee8c"));function u(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(i,o){try{var u=t[i](o),a=u.value}catch(e){return void n(e)}if(!u.done)return Promise.resolve(a).then(function(e){r("next",e)},function(e){r("throw",e)});e(a)}("next")})}}var c=t.Statuses={ONGOING:"ONGOING",PAUSED:"PAUSED",ENDED:"ENDED"};t.Thumbs={UP:"UP",DOWN:"DOWN",MIDDLE:"MIDDLE"},t.default=function e(t,n,u){var l=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.isOngoingOrPausedForAnotherCard=function(){var e=s(function*(e){var t=yield l.boardStorage.getDiscussionStatus(e),n=yield l.boardStorage.getDiscussionCardId(e);return[c.ONGOING,c.PAUSED].includes(t)&&n!==e.getContext().card});return function(t){return e.apply(this,arguments)}}(),this.isOngoingFor=function(){var e=s(function*(e){var t=yield l.cardStorage.getDiscussionStatus(e);return c.ONGOING===t});return function(t){return e.apply(this,arguments)}}(),this.isPausedFor=function(){var e=s(function*(e){var t=yield l.cardStorage.getDiscussionStatus(e);return c.PAUSED===t});return function(t){return e.apply(this,arguments)}}(),this.getElapsed=function(e){return l.cardStorage.getDiscussionElapsed(e)},this.updateElapsed=function(){var e=s(function*(e){var t=yield l.boardStorage.getDiscussionStartedAt(e);Date.now()-t>l.maxDiscussionDuration?l.pause(e):l.saveElapsed(e)});return function(t){return e.apply(this,arguments)}}(),this.saveElapsed=function(){var e=s(function*(e){var t=yield l.boardStorage.getDiscussionStartedAt(e),n=(yield l.boardStorage.getDiscussionPreviousElapsed(e))||0,r=t?Date.now()-t:0;l.cardStorage.saveDiscussionElapsed(e,r+n)});return function(t){return e.apply(this,arguments)}}(),this.start=function(){var e=s(function*(e){var t;l.boardStorage.writeMultiple(e,(a(t={},r.default.DISCUSSION_STATUS,c.ONGOING),a(t,r.default.DISCUSSION_CARD_ID,e.getContext().card),a(t,r.default.DISCUSSION_STARTED_AT,Date.now()),a(t,r.default.DISCUSSION_PREVIOUS_ELAPSED,yield l.getElapsed(e)),a(t,r.default.DISCUSSION_INTERVAL_ID,setInterval(l.updateElapsed,5e3,e)),t)),yield l.cardStorage.saveDiscussionStatus(e,c.ONGOING),yield l.cardStorage.deleteDiscussionThumbs(e)});return function(t){return e.apply(this,arguments)}}(),this.pause=function(){var e=s(function*(e){var t,n=yield l.boardStorage.getDiscussionIntervalId(e),i=yield l.boardStorage.getDiscussionCardId(e),o=(yield e.cards("id","name")).find(function(e){return e.id===i}).name;clearInterval(n),l.cardStorage.saveDiscussionStatus(e,c.PAUSED),l.saveElapsed(e),l.boardStorage.writeMultiple(e,(a(t={},r.default.DISCUSSION_STATUS,c.PAUSED),a(t,r.default.DISCUSSION_STARTED_AT,null),a(t,r.default.DISCUSSION_PREVIOUS_ELAPSED,yield l.getElapsed(e)),a(t,r.default.DISCUSSION_INTERVAL_ID,null),t)),l.notifications.play(l.notifications.Types.ELAPSED),l.notifications.show(l.notifications.Types.ELAPSED,o)});return function(t){return e.apply(this,arguments)}}(),this.end=function(){var e=s(function*(e){var t=yield l.boardStorage.getDiscussionIntervalId(e);clearInterval(t);try{yield l.cardStorage.saveDiscussionStatus(e,c.ENDED),yield l.saveElapsed(e),yield l.cardStorage.deleteMultiple(e,[i.default.DISCUSSION_THUMBS]),yield l.boardStorage.deleteMultiple(e,[r.default.DISCUSSION_STATUS,r.default.DISCUSSION_CARD_ID,r.default.DISCUSSION_STARTED_AT,r.default.DISCUSSION_PREVIOUS_ELAPSED,r.default.DISCUSSION_INTERVAL_ID])}catch(e){throw new Error(e)}});return function(t){return e.apply(this,arguments)}}(),this.w=t,this.baseUrl=n,this.notifications=new o.default(this.w,this.baseUrl),this.maxDiscussionDuration=u,this.boardStorage=new r.default,this.cardStorage=new i.default}},e9aab379f407c6096333:function(e,t,n){(function(e){var r=void 0!==e&&e||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function o(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new o(i.call(setTimeout,r,arguments),clearTimeout)},t.setInterval=function(){return new o(i.call(setInterval,r,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(r,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n("c4f90655ae719ce885a6"),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n("698d75b157f24ae829cc"))},f1e2a52aad8d956dc791:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(i,o){try{var u=t[i](o),a=u.value}catch(e){return void n(e)}if(!u.done)return Promise.resolve(a).then(function(e){r("next",e)},function(e){r("throw",e)});e(a)}("next")})}}var o=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.getVoters=function(){var e=i(function*(e){var t=(yield r.voting.getVotes(e))||{};return Object.values(t).reduce(function(e,t){return t.username&&e.push({text:t.username+" ("+t.fullName+")"}),e},[])});return function(t){return e.apply(this,arguments)}}(),this.baseUrl=t,this.voting=n,this.render=this.render.bind(this)}return r(e,[{key:"render",value:function(){var e=i(function*(e){var t=yield this.getVoters(e);if(!t.length)return null;var n=yield this.voting.hasCurrentMemberVoted(e);return{text:t.length,color:n?"blue":null,icon:this.baseUrl+"/assets/powerup/"+(n?"heart_white.svg":"heart.svg")}});return function(t){return e.apply(this,arguments)}}()}]),e}();t.default=o},fec2ccc126ffad19d204:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var u=i.get;return void 0!==u?u.call(r):void 0},i=function(e){return e&&e.__esModule?e:{default:e}}(n("f1e2a52aad8d956dc791"));function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(i,o){try{var u=t[i](o),a=u.value}catch(e){return void n(e)}if(!u.done)return Promise.resolve(a).then(function(e){r("next",e)},function(e){r("throw",e)});e(a)}("next")})}}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var a=function(e){function t(){var e,n,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,s=Array(a),c=0;c<a;c++)s[c]=arguments[c];return n=i=u(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),i.showVoters=function(){var e=o(function*(e){var t=yield i.getVoters(e);t.length&&e.popup({title:"Voters",items:t})});return function(t){return e.apply(this,arguments)}}(),i.render=function(){var e=o(function*(e){var n=yield r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"render",i).call(i,e);return n&&(n.title="Voters",delete n.icon,n.callback=i.showVoters),n});return function(t){return e.apply(this,arguments)}}(),u(i,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),t}();t.default=a}});
//# sourceMappingURL=main.2f715bdeb68ff633a264.js.map